# 좌표 측정 기계를 위한 신경 프로세스 강화된 가공 오차 평가

## 요약
우리는 복잡한 표면의 가공 오차를 효율적으로 평가하기 위해 신경 네트워크 프로세스 기반의 접근법을 제안합니다.

### 가공 오차 재구성 모델:
1. 특징 추출 모듈을 사용하여 희소한 측정값에서 지역 및 전역 특징을 추출합니다.
   - 인접 특징을 결합하는 특징 집계 모듈
   - 가공 오차 분포를 모델링하고 밀집 오차 맵을 재구성하는 분포 재구성 모듈
2. 재구성 불확실성에 기초하여 고 불확실성 지역에서 추가 샘플링을 안내하는 적응적 샘플링 전략.

제안된 신경 네트워크 프로세스 모델은 합성 프랙탈 브라운 운동 데이터 세트 및 실제 가공 작업부품 측정에서 전통적인 기술 및 초해상도 네트워크보다 더 높은 재구성 정확도를 보입니다.

적응적 샘플링은 무작위 샘플링과 비교하여 높은 불확실성 지역에 샘플링 점을 집중함으로써 샘플링 점의 수를 줄이면서도 정확도를 손상시키지 않습니다.

제안된 방법은 정밀 제조 응용 분야에서 좌표 측정 기계를 사용하여 대규모 표면 측정의 효율성과 정확도를 높일 수 있습니다.

## 기존 한계
기존의 접촉 측정 방법(예: 표면 프로파일러, 좌표 측정 기계)은 점 대 점 샘플링에 의존하여 시간이 많이 소요됩니다. 특히 복잡하고 대규모 표면의 고해상도 측정은 많은 시간이 소요됩니다.

기존의 재구성 알고리즘은 주로 명시적 및 암시적 방법으로 나뉩니다:
- 명시적 방법((Bi-Cu, B-spline NURBS 등): 간단하지만 전역 일관성을 모델링하지 못합니다.
- 암시적 방법(최소 제곱 (LS), 방사 기저 함수 (RBFs) 등): 전역 상관 관계를 모델링하며 높은 정확도를 가지지만 계산 복잡성이 높으며 통계에 대한 사전 지식이 필요합니다.

기존의 적응적 샘플링 기술은 재구성 불확실성을 평가하여 샘플링 밀도를 조정하지만 불확실성 평가 자체가 높은 계산 비용을 요구합니다.

> 기존의 방법은 측정 및 재구성 효율, 정확도 및 계산 복잡성과 같은 한계로 인해 복잡한 대규모 표면을 측정하기 어렵습니다.

## 제안 방법
신경 프로세스를 기반으로 한 효율적인 가공 오차 평가 방법을 제안합니다.
![모델 프레임 워크](https://github.com/Prcnsi/Deep-learning-based_CMM_Anomaly-detection/assets/88486391/8508dc51-40cc-4699-96f6-1cc1e2662156)
1. 대상 표면을 희소하게 샘플링하고 설계 표면과 정렬하여 희소 가공 오차를 얻습니다.
2. 희소한 가공 오차를 신경 네트워크 프로세스 모델에 입력하여 지역 및 전역 특징을 추출합니다.
3. 재구성 모듈에서 밀집 가공 오차 맵 및 불확실성 맵을 생성합니다.
4. (선택 사항) 불확실성 맵을 기반으로 한 적응적 추가 샘플링을 수행하여 정확도를 향상시킵니다.

![세부 구현 사항](https://github.com/Prcnsi/Deep-learning-based_CMM_Anomaly-detection/assets/88486391/3961c7fd-849f-4d26-b597-992b559a36e6)

### 각 모듈에 대한 설명

1) 가공 오차 재구성 모델
- 특징 추출 모듈: 희소한 측정값에서 지역 및 전역 다중 스케일 특징을 추출합니다.
  - 입력: 희소 가공 오차 (xC, eC) = {(xi, ei)}
  - 출력: 역 특징 ri, 전역 특징 si
  - 목적: 희소한 측정값에서 다중 스케일 특징을 추출하여 표현력을 향상시킵니다.
- 특징 집계 모듈: 주변 특징을 결합하여 대상 위치의 지역 특징을 생성하는 주의 메커니즘을 사용합니다.
  - 입력: 지역 특징 ri, 전역 특징 si, 대상 위치 xt
  - 출력: 대상 위치의 지역 특징 r*, 전역 특징 s*
  - 목적: 주변 특징을 사용하여 대상 위치 특징을 생성합니다.
- 분포 재구성 모듈: 지역/전역 특징을 융합하여 가공 오차 분포를 모델링하고 예상 값으로 밀집 오차 맵을 재구성하며 불확실성(가공 오차 분포)을 분산으로 평가합니다.
  - 입력: 지역 특징 r*, 전역 특징 s*
  - 출력: 밀집 가공 오차 맵 ME(xt), 불확실성 맵 D(xt)
  - Process: 랜덤 변수 z를 s에서 CPS로 샘플링하여 r, z를 MLPR로 입력하여 오차 et를 예측합니다. 여러 et 샘플의 평균과 분산을 계산하여 ME(xt) 및 D(xt)를 생성합니다.

2) 불확실성 기반 적응적 샘플링 전략
- 재구성된 오차 맵의 불확실성(분산)을 활용하여 고 불확실성 영역에 추가 샘플링 지점을 배치합니다.
- 불확실성 평가를 반복적으로 수행하여 정확도 요구 사항을 충족합니다.
  - 입력: 불확실성 맵 D(xt), 정확도 요구 사항
  - 출력: 업데이트된 샘플링 위치 x'C
  - Process: D(xt)에서 고 불확실성 영역 x'T를 선택하여 x'T에서 추가 샘플링을 생성합니다. 불확실성이 충족될 때까지 1-3을 반복하여 재구성합니다.

## 강점
- 신경 네트워크 프로세스를 통해 지역 세부 정보와 전역 모양 일관성을 동시에 모델링하여 정확한 재구성이 가능합니다.
- 불확실성 평가를 통해 효율적인 적응적 샘플링이 가능합니다.
- 계산 복잡성을 O(n)의 선형 시간으로 대규모로 측정할 수 있습니다.
- 데이터 기반 학습을 통해 수동적인 통계적 사전 지식을 조정할 필요가 없습니다.

## 실험
1) 모델 훈련 및 합성 fBm 데이터셋
- 지도 학습 방법을 사용하여 신경망 모델을 훈련합니다.
- 합성 프랙탈 브라운 운동(fBm) 데이터셋을 사용하여 모델을 훈련합니다.
- fBm 데이터셋은 가공 오차를 모델링하기 위해 사용되었으며 매개변수를 조정하여 10,000개의 샘플을 생성했습니다.
2) 희소 샘플링에서의 재구성 검증
- 실제 가공된 세 개의 복잡한 표면에 대해 실험을 진행합니다.
- 제안된 방법을 기존의 재구성 방법과 질적 및 양적으로 비교합니다.
- 제안된 방법은 높은 정확도를 보여줍니다.
3) 불확실성 기반 적응적 샘플링 전략 검증
- 불확실성을 기반으로 한 적응적 샘플링 전략을 검증합니다.
- 적응적 샘플링은 무작위 샘플링보다 높은 샘플링 효율을 보여줍니다.
- 적응적 샘플링이 대상 표면의 전역 및 지역 특징을 진행적으로 탐색하는지 확인합니다.
